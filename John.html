<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>מחשבון בלוקי ג'ונסון – לפי הסט שלך בלבד</title>
<style>
:root{--bg:#0b0c10;--card:#14171d;--ink:#f2f2f2;--accent:#4da3ff;--line:#1f232b}
body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
background:var(--bg);color:var(--ink)}
header{text-align:center;padding:20px}
h1{margin:0;font-size:1.4rem}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;
padding:18px;margin:12px auto;max-width:720px;box-shadow:0 2px 10px rgba(0,0,0,.25)}
input,button{width:100%;padding:10px;border-radius:8px;border:1px solid var(--line);
background:#0e1216;color:var(--ink);font-size:1rem}
button{background:var(--accent);color:#001428;font-weight:700;cursor:pointer}
.result{line-height:1.8;font-size:1.1rem}
.comment{color:#a7a7a7;font-size:.95rem;margin-top:10px}
</style>
</head>
<body>
<header>
<h1>מחשבון בלוקי ג'ונסון – לפי הסט שלך</h1>
<div style="color:#a7a7a7;font-size:.9rem">מותאם אחד לאחד לסט שבתמונה שלך</div>
</header>

<div class="card">
<label>מידה נדרשת (מ״מ)</label>
<input id="val" type="number" step="0.001" placeholder="לדוגמה: 27.7">
<button id="calc" style="margin-top:10px">חשב</button>
</div>

<div id="out" class="card" style="display:none"></div>

<script>
// הסט בפועל בדיוק כפי שבתמונה שלך:
const blocks = [
  1.005,1.006,1.007,1.008,1.009,
  1.01,1.02,1.03,1.04,1.05,1.06,1.07,1.08,1.09,
  1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,
  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,
  20,30,50
];

function findClosestCombo(target){
  let best=null;
  const n=blocks.length;
  function dfs(start,sum,combo){
    const diff = target - sum;
    if(Math.abs(diff) < 0.0005){
      best={combo:[...combo],sum};
      return true;
    }
    if(sum>target || combo.length>4) return false;
    for(let i=start;i<n;i++){
      dfs(i+1,sum+blocks[i],[...combo,blocks[i]]);
    }
  }
  dfs(0,0,[]);
  if(best) return best;

  // אם אין התאמה מדויקת נחפש הכי קרוב
  let closest={err:999,combo:[]};
  function scan(start,sum,combo){
    if(combo.length>4)return;
    const err=Math.abs(target-sum);
    if(err<closest.err)closest={err,sum,combo:[...combo]};
    for(let i=start;i<n;i++){
      scan(i+1,sum+blocks[i],[...combo,blocks[i]]);
    }
  }
  scan(0,0,[]);
  return closest;
}

function cleanLabel(b){
  // הצגה טבעית לפי מה שכתוב על הבלוק שלך
  if (b % 1 === 0) return `${b}`;        // שלם
  if (b >= 1 && b < 2) return `${b.toFixed(1)}`; // עשיריות
  if (b > 1 && b < 1.1) return `${b.toFixed(2)}`; // מאיות
  if (b < 1.01) return `${b.toFixed(3)}`;         // אלפיות
  return `${b}`;
}

function formatBlocks(arr){
  return arr.map(b=>`→ ${cleanLabel(b)}`).join("<br>");
}

document.getElementById("calc").onclick=()=>{
  const target=parseFloat(document.getElementById("val").value);
  if(isNaN(target))return alert("הכנס מידה תקפה במ״מ");
  const res=findClosestCombo(target);
  const sum=+res.sum.toFixed(3);
  const diff=(sum - target).toFixed(3);
  const out=document.getElementById("out");
  out.style.display="block";
  out.innerHTML=`
  <div class="result">
  קח את הבלוקים:<br><br>${formatBlocks(res.combo)}
  <br><br><b>סכום בפועל:</b> ${sum} מ״מ
  </div>
  <div class="comment">
  ${diff==0 ? "מדויק לחלוטין" : `עיגול של ${diff>0?"+":"−"}${Math.abs(diff)} מ״מ כדי להתאים לסט`}
  </div>`;
};
</script>
</body>
</html>

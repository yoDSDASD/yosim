<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, viewport-fit=cover">
  <title>ISO 286 Auto-Grade</title>
  <style>
    :root{--bg:#05070a;--card:#11141d;--accent:#10d07a;--warn:#ff4757;--fg:#e2e8f0;--line:#222938;}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,sans-serif;padding:12px;display:flex;justify-content:center;touch-action:manipulation;}
    .app{width:100%;max-width:400px;background:var(--card);border:1px solid var(--line);border-radius:24px;padding:24px;}
    h1{font-size:1.1rem;margin:0 0 20px;text-align:center;color:var(--accent);}
    label{display:block;font-size:0.85rem;margin-bottom:6px;color:#8892b0;}
    input, select{width:100%;font-size:18px;padding:16px;border-radius:14px;border:2px solid var(--line);background:#000;color:#fff;outline:none;box-sizing:border-box;margin-bottom:15px;}
    .pin{padding:20px;border-radius:18px;background:#161b29;margin-top:12px;border-right:8px solid var(--accent);animation:slideIn 0.3s ease-out;}
    .pin.nogo{border-right-color:var(--warn);}
    .val{font-size:2.2rem;font-weight:900;font-family:monospace;display:block;}
    .auto-badge{display:inline-block;padding:2px 8px;background:var(--accent);color:#000;border-radius:4px;font-size:0.7rem;font-weight:bold;margin-right:5px;}
    @keyframes slideIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
  </style>
</head>
<body>
  <div class="app">
    <h1>מחשבון קדח — זיהוי דרגה אוטומטי</h1>
    <label>קוטר נומינלי (מ"מ)</label>
    <input id="nom" type="number" step="0.001" inputmode="decimal" placeholder="הקש מידה..." autofocus>
    
    <label>דרגת דיוק <span id="autoLabel" class="auto-badge" style="display:none">זיהוי אוטומטי</span></label>
    <select id="it">
      <script>for(let i=1;i<=11;i++) document.write(`<option value="${i}" ${i==7?'selected':''}>H${i}</option>`);</script>
    </select>

    <div id="res" style="display:none">
      <div class="pin"><span style="color:#8892b0">פין עובר (GO)</span><span class="val" id="goVal"></span></div>
      <div class="pin nogo"><span style="color:#8892b0">פין לא-עובר (NO-GO)</span><span class="val" id="noVal"></span></div>
    </div>
  </div>

<script>
const DATA = [
  {r:[0,3],1:0.8,2:1.2,3:2,4:3,5:4,6:6,7:10,8:14,9:25,10:40,11:60},
  {r:[3,6],1:1,2:1.5,3:2.5,4:4,5:5,6:8,7:12,8:18,9:30,10:48,11:75},
  {r:[6,10],1:1,2:1.5,3:2.5,4:4,5:6,6:9,7:15,8:22,9:36,10:58,11:90},
  {r:[10,18],1:1.2,2:2,3:3,4:5,5:8,6:11,7:18,8:27,9:43,10:70,11:110},
  {r:[18,30],1:1.5,2:2.5,3:4,4:6,5:9,6:13,7:21,8:33,9:52,10:84,11:130},
  {r:[30,50],1:1.5,2:2.5,3:4,4:7,5:11,6:16,7:25,8:39,9:62,10:100,11:160},
  {r:[50,80],1:2,2:3,3:5,4:8,5:13,6:19,7:30,8:46,9:74,10:120,11:190},
  {r:[80,120],1:2.5,2:4,3:6,4:10,5:15,6:22,7:35,8:54,9:87,10:140,11:220},
  {r:[120,180],1:3.5,2:5,3:8,4:12,5:18,6:25,7:40,8:63,9:100,10:160,11:250},
  {r:[180,250],1:4.5,2:7,3:10,4:14,5:20,6:29,7:46,8:72,9:115,10:185,11:290},
  {r:[250,315],1:6,2:8,3:12,4:16,5:23,6:32,7:52,8:81,9:130,10:210,11:320},
  {r:[315,400],1:7,2:9,3:13,4:18,5:25,6:36,7:57,8:89,9:140,10:230,11:360},
  {r:[400,500],1:8,2:10,3:15,4:20,5:27,6:40,7:63,8:97,9:155,10:250,11:400}
];

function calc(isManual = false){
  const d=parseFloat(document.getElementById('nom').value);
  const itSelect=document.getElementById('it');
  
  if(!d||d<=0||d>500){document.getElementById('res').style.display='none';return;}

  if(!isManual) {
    let autoGrade = d <= 3 ? 6 : d <= 10 ? 7 : d <= 30 ? 8 : 9;
    itSelect.value = autoGrade;
    document.getElementById('autoLabel').style.display = 'inline-block';
  }

  const row=DATA.find(s=>d>s.r[0]&&d<=s.r[1]);
  if(row){
    document.getElementById('goVal').textContent=d.toFixed(4);
    document.getElementById('noVal').textContent=(d+(row[itSelect.value]/1000)).toFixed(4);
    document.getElementById('res').style.display='block';
  }
}

document.getElementById('nom').oninput= () => calc(false);
document.getElementById('it').onchange= () => {
  document.getElementById('autoLabel').style.display = 'none';
  calc(true);
};
</script>
</body>
</html>

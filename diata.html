<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Heli 1200 Dark - Ultimate</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --bg: #121212; 
            --card: #1e1e1e; 
            --text: #e0e0e0; 
            --accent: #4dabf7; 
            --success: #69f0ae; 
            --border: #333;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 12px; padding-bottom: 80px; }
        .motivation-bar { background: linear-gradient(90deg, #1a237e, #0d47a1); color: #fff; padding: 15px; border-radius: 12px; text-align: center; font-weight: bold; margin-bottom: 15px; border: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; position: sticky; top: 10px; z-index: 100; }
        .stat-box { background: var(--card); padding: 12px; border-radius: 12px; text-align: center; border: 1px solid var(--border); box-shadow: 0 4px 6px rgba(0,0,0,0.3); backdrop-filter: blur(10px); }
        h2, h3 { color: var(--accent); margin: 0 0 5px 0; font-size: 1.1rem; }
        label { font-size: 0.8rem; color: #aaa; display: block; margin-bottom: 5px; }
        select, input { width: 100%; padding: 14px; border-radius: 10px; border: 1px solid var(--border); background: #2c2c2c; color: #fff; font-size: 0.95rem; margin-bottom: 12px; appearance: none; }
        button { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
        .card { background: var(--card); border-radius: 16px; padding: 15px; margin-bottom: 15px; border: 1px solid var(--border); }
        .meal-header { display: flex; justify-content: space-between; align-items: baseline; border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 12px; }
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #1a1a1a; padding: 10px; display: flex; gap: 10px; border-top: 1px solid #333; z-index: 1000; }
        .nav-btn { background: #333; color: var(--text); flex: 1; font-size: 0.8rem; }
        .nav-btn.active { background: var(--accent); color: #000; }
        #modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:2000; justify-content:center; align-items:center; }
        .modal-content { background: var(--card); width: 90%; max-height: 85%; border-radius: 15px; padding: 20px; overflow-y: auto; border: 1px solid var(--border); }
        .info-text ul { padding-right: 20px; color: #ccc; font-size: 0.9rem; line-height: 1.6; }
    </style>
</head>
<body>

<div id="quote" class="motivation-bar">×™×•×¡×£, ×”×“×™×•×§ ×‘×¤×¨×˜×™× ×”×§×˜× ×™× ×”×•× ×¡×•×“ ×”×”×¦×œ×—×”!</div>

<div class="stats-row">
    <div class="stat-box">
        <div id="cur-date" style="font-size: 0.75rem; color: #888;">×”×™×•×</div>
        <div id="cal-count" style="font-size: 1.5rem; font-weight: bold; color: var(--accent);">0</div>
        <div style="font-size: 0.7rem;">×§×œ×•×¨×™×•×ª</div>
    </div>
    <div class="stat-box">
        <div style="font-size: 0.75rem; color: #888;">××©×§×œ ××—×¨×•×Ÿ</div>
        <div id="last-weight" style="font-size: 1.5rem; font-weight: bold; color: var(--success);">--</div>
        <div style="font-size: 0.7rem;">×§×´×’</div>
    </div>
</div>

<div id="app"></div>

<div class="card">
    <h3>××¢×§×‘ ××©×§×œ</h3>
    <div style="display:flex; gap:10px;">
        <input type="number" id="w-in" step="0.1" placeholder="×§×´×’" style="flex:1; margin:0;">
        <button onclick="addW()" style="background:var(--success); color:#000; width:auto; padding:0 25px;">×¢×“×›×Ÿ</button>
    </div>
    <canvas id="wChart" style="margin-top:15px; max-height:150px;"></canvas>
</div>

<div class="nav-bar">
    <button class="nav-btn" onclick="changeDate(-1)">××ª××•×œ</button>
    <button class="nav-btn active" onclick="openInfo()">â„¹ï¸ ×“×’×©×™×</button>
    <button class="nav-btn" onclick="openReport()">ğŸ“ ×¡×™×›×•×</button>
    <button class="nav-btn" onclick="changeDate(1)">××—×¨</button>
</div>

<div id="modal">
    <div class="modal-content">
        <h2 id="modal-title" style="text-align:center; border-bottom:1px solid #333; padding-bottom:10px;"></h2>
        <div id="modal-body" class="info-text"></div>
        <button onclick="closeModal()" style="margin-top:15px; background:#d32f2f; color:white;">×¡×’×•×¨</button>
    </div>
</div>

<script>
const DB = {
    carbs: ["1 ×¤×™×ª×” ×§×œ×”", "2 ×¤×¨×•×¡×•×ª ×œ×—× ×§×œ", "1/2 ×›×•×¡ ××•×¨×–/×¤×¡×˜×”/×¤×ª×™×ª×™×/×‘×•×¨×’×•×œ", "1 ×ª×¤×•×— ××“××” ×‘×™× ×•× ×™", "1/2 ×‘×˜×˜×”", "3 ×¤×ª×™×ª", "2 ×¤×™×¨×›×™×•×ª", "1/2 ×›×•×¡ ×§×˜× ×™×•×ª", "1 ×—×˜×™×£ ×× ×¨×’×™×” (×¢×“ 100 ×§×œ')", "1/2 ×˜×•×¨×˜×™×”"],
    cheese: ["2 ×›×¤×•×ª ×’×‘×™× ×” 5%", "1 ×¤×¨×•×¡×ª ×¦×”×•×‘×” 9%", "60 ×’×¨× ×‘×•×œ×’×¨×™×ª 5%", "1 ×‘×™×¦×”", "1/2 ×§×•×¤×¡×ª ×˜×•× ×” ×‘××™×", "1 ×’×‘×™×¢ ×™×•×’×•×¨×˜ 0-1.5%", "1 ××¦×‘×¢ ××•×¦×¨×œ×”", "60 ×’×¨× ×˜×•×¤×•"],
    meat: ["150 ×’×¨× ×—×–×” ×¢×•×£/×¤×¨×’×™×ª", "150 ×’×¨× ×‘×§×¨ ×¨×–×”", "200 ×’×¨× ×“×’ ××¤×•×™", "1.5 ×§×•×¤×¡××•×ª ×˜×•× ×” ×‘××™×", "3 ×§×¦×™×¦×•×ª ×‘×§×¨", "6 ×›×“×•×¨×™ ×¤×œ××¤×œ ××¤×•×™×™×"],
    fat: ["1 ×›×¤×™×ª ×©××Ÿ", "1 ×›×£ ×˜×—×™× ×” ××•×›× ×”", "1 ×›×£ ××‘×•×§×“×•", "6 ×–×™×ª×™×", "7 ×©×§×“×™×", "3 ××’×•×–×™ ××œ×š", "1 ×›×¤×™×ª ××™×•× ×–"],
    fruit: ["×ª×¤×•×—", "×‘× × ×” ×§×˜× ×”", "××’×¡", "2 ×©×–×™×¤×™×", "1 ×›×•×¡ ×¢× ×‘×™×", "1 ×ª××¨ ××’'×”×•×œ", "2 ×§×œ×× ×˜×™× ×•×ª", "1 ×›×•×¡ ××‘×˜×™×—"],
    half_cheese: ["×¤×¨×•×¡×ª ×¦×”×•×‘×” 5%", "×›×£ ×’×‘×™× ×” 5%", "30 ×’×¨× ×‘×•×œ×’×¨×™×ª", "×—×¦×™ ×‘×™×¦×”", "2 ×¤×¨×•×¡×•×ª ×¤×¡×˜×¨××”"]
};

const mealsConfig = [
    { n: "××¨×•×—×ª ×‘×•×§×¨", t: "09:00", c: 200, p: [{l: "×¤×—××™××”", d: DB.carbs}, {l: "×—×œ×‘×•×Ÿ ×’×‘×™× ×”", d: DB.cheese}] },
    { n: "×‘×™× ×™×™× ×‘×•×§×¨", t: "11:00", c: 150, p: [{l: "×¤×¨×™", d: DB.fruit}, {l: "×©×•××Ÿ", d: DB.fat}] },
    { n: "××¨×•×—×ª ×¦×”×¨×™×™×", t: "12:00", c: 350, p: [{l: "×—×œ×‘×•×Ÿ ×‘×©×¨", d: DB.meat}, {l: "×¤×—××™××”", d: DB.carbs}, {l: "×©×•××Ÿ", d: DB.fat}] },
    { n: "×‘×™× ×™×™× ××—×”×´×¦", t: "15:00", c: 150, p: [{l: "×¤×—××™××”", d: DB.carbs}, {l: "×¤×¨×™", d: DB.fruit}, {l: "×©×•××Ÿ", d: DB.fat}] },
    { n: "××¨×•×—×ª ×¢×¨×‘", t: "18:00", c: 250, p: [{l: "×¤×—××™××”", d: DB.carbs}, {l: "×—×œ×‘×•×Ÿ ×’×‘×™× ×”", d: DB.cheese}, {l: "×—×¦×™ ×—×œ×‘×•×Ÿ", d: DB.half_cheese}, {l: "×©×•××Ÿ", d: DB.fat}] },
    { n: "××¨×•×—×ª ×œ×™×œ×”", t: "21:00", c: 100, p: [{l: "×—×œ×‘×•×Ÿ ×’×‘×™× ×”", d: DB.cheese}, {l: "×¤×¨×™", d: DB.fruit}] }
];

const guidelinesHTML = `
<ul>
    <li>×œ× × ×™×ª×Ÿ ×œ×¤×¦×œ, ×œ×¦×¨×£ ××• ×œ×“×œ×’ ×¢×œ ××¨×•×—×•×ª.</li>
    <li>×× ×” ××•×ª×¨×ª ×‘× ×•×¡×£ ×œ×ª×¤×¨×™×˜ ×¤×¢× ×‘×©×‘×•×¢.</li>
    <li>×›×•×¡ ×—×œ×‘ ×‘×™×•× ×œ×§×¤×” (×‘× ×•×¡×£ ×œ×ª×¤×¨×™×˜).</li>
    <li>×™×¨×§×•×ª × ×™×ª×Ÿ ×œ×©×œ×‘ ×‘×›×œ ××¨×•×—×” ×‘×©×¤×™×•×ª ×•×‘×¦×œ×™×œ×•×ª ×”×“×¢×ª.</li>
    <li>×™×© ×œ×©×ª×•×ª ××™× ×™××•× 12 ×›×•×¡×•×ª ××™× ×‘×™×•×.</li>
    <li>××•××œ×¥ ×œ×©×ª×•×ª ×›×•×¡ ××™× ×œ×¤× ×™ ×•××—×¨×™ ×›×œ ××¨×•×—×”.</li>
    <li>×™×© ×œ×”×§×¤×™×“ ×¢×œ ××“×™×“×” ××“×•×™×§×ª ×©×œ ×”×›××•×™×•×ª.</li>
    <li>××•××œ×¥ ×œ×’×•×•×Ÿ ×¢× ×ª×—×œ×™×¤×™× ××”×—×•×‘×¨×ª/××ª×¨.</li>
    <li>××•××œ×¥ ×”×œ×™×›×” ×©×œ ×©×¢×”, 3 ×¤×¢××™× ×‘×©×‘×•×¢.</li>
    <li>××–×•×Ÿ ×¢× ×××ª×™×§ ××œ××›×•×ª×™ - ×œ×¦×¨×•×š ×‘××ª×™× ×•×ª.</li>
    <li>×¢×“×™×¤×•×ª ×œ×¤×—××™××•×ª ×•×“×’× ×™× ××œ××™×.</li>
    <li>××¨×•×—×” ×¨××©×•× ×”: ×¢×“ ×©×¢×” ××”×™×§×™×¦×”.</li>
    <li>××¨×•×•×— ×‘×™×Ÿ ××¨×•×—×•×ª: ×©×¢×” ×•×—×¦×™ ×¢×“ ×©×œ×•×© ×©×¢×•×ª.</li>
    <li>× ×™×ª×Ÿ ×œ×”×—×œ×™×£ ×‘×™×Ÿ ××¨×•×—×•×ª ×©×œ××•×ª (×œ××©×œ ×¢×¨×‘ ×‘×¦×”×¨×™×™×).</li>
</ul>
`;

let vDate = new Date();
let data = JSON.parse(localStorage.getItem('heli_ultimate_v2')) || { days:{}, weights:[] };

function getK(d){ return d.toLocaleDateString('he-IL').replace(/\./g,'-'); }

function init() {
    const k = getK(vDate);
    document.getElementById('cur-date').innerText = k === getK(new Date()) ? "×”×™×•×" : k;
    const day = data.days[k] || {};
    
    document.getElementById('app').innerHTML = mealsConfig.map((m, i) => `
        <div class="card">
            <div class="meal-header">
                <div>
                    <h3 style="display:inline;">${m.n}</h3>
                    <span style="font-size:0.8rem; color:var(--accent); margin-right:8px;">${m.t}</span>
                </div>
                <span style="font-size:0.8rem; color:#888;">${m.c} ×§×œ'</span>
            </div>
            ${m.p.map((part, pi) => `
                <div>
                    <label>${part.l}</label>
                    <select onchange="updM('${k}', '${i}_${pi}', this.value)">
                        <option value="">×‘×—×¨...</option>
                        ${part.d.map(x => `<option value="${x}" ${day[i+'_'+pi]===x?'selected':''}>${x}</option>`).join('')}
                    </select>
                </div>
            `).join('')}
        </div>
    `).join('');
    updateStats(day);
    renderChart();
}

function updM(k, id, v){ if(!data.days[k]) data.days[k]={}; data.days[k][id]=v; save(); updateStats(data.days[k]); }
function addW(){ const v = document.getElementById('w-in').value; if(!v)return; data.weights.push({d:getK(new Date()), w:parseFloat(v)}); save(); init(); }
function updateStats(day){
    let t = 0;
    mealsConfig.forEach((m, i) => {
        let active = false;
        m.p.forEach((_, pi) => { if(day[i+'_'+pi]) active = true; });
        if(active) t += m.c;
    });
    document.getElementById('cal-count').innerText = t;
    if(data.weights.length) document.getElementById('last-weight').innerText = data.weights[data.weights.length-1].w;
}

function save(){ localStorage.setItem('heli_ultimate_v2', JSON.stringify(data)); }
function changeDate(n){ vDate.setDate(vDate.getDate()+n); init(); }
function closeModal() { document.getElementById('modal').style.display = 'none'; }

function openInfo() {
    document.getElementById('modal-title').innerText = "×“×’×©×™× ×œ×”×¦×œ×—×”";
    document.getElementById('modal-body').innerHTML = guidelinesHTML;
    document.getElementById('modal').style.display = 'flex';
}

function openReport() {
    const k = getK(vDate);
    const day = data.days[k] || {};
    let html = '';
    mealsConfig.forEach((m, i) => {
        html += `<div style="margin-bottom:12px; border-bottom:1px solid #333; padding-bottom:8px;">
            <strong style="color:var(--accent)">${m.n} (${m.t})</strong><br>`;
        m.p.forEach((p, pi) => {
            if(day[i+'_'+pi]) html += `<div style="font-size:0.85rem;">â€¢ ${p.l}: ${day[i+'_'+pi]}</div>`;
        });
        html += `</div>`;
    });
    document.getElementById('modal-title').innerText = "×¡×™×›×•× ×™×•××™: " + k;
    document.getElementById('modal-body').innerHTML = html || "××™×Ÿ × ×ª×•× ×™× ×œ×™×•× ×–×”.";
    document.getElementById('modal').style.display = 'flex';
}

function renderChart(){
    const ctx = document.getElementById('wChart').getContext('2d');
    if(window.myChart) window.myChart.destroy();
    const d = data.weights.slice(-7);
    window.myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: d.map(x=>x.d),
            datasets: [{ label:'×§×´×’', data:d.map(x=>x.w), borderColor:'#4dabf7', tension:0.4, fill:true, backgroundColor:'rgba(77,171,247,0.1)' }]
        },
        options: { plugins:{legend:{display:false}}, scales:{x:{display:false}, y:{grid:{color:'#333'}}} }
    });
}

init();
</script>
</body>
</html>
